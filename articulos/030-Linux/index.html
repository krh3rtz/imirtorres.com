<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Pelican Static Site Generator, Powered by Python" />
    <meta name="description" content="El siguiente, más que un manual paso a paso, son los comandos utilizados en el video para preparar una instalación de Debian con el sistema de archivos BTRFS.">
    <meta name="keywords" content="Linux, articulos">
    <meta name="author" content="Imir Torres">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:site" content="">
    <meta name="twitter:title" content="Linux Anti Ransomware">
    <meta name="twitter:description" content="El siguiente, más que un manual paso a paso, son los comandos utilizados en el video para preparar una instalación de Debian con el sistema de archivos BTRFS.">
    <meta name="twitter:image" content="/articulos/030-Linux/preview1.png">
    <meta property="og:title" content="Linux Anti Ransomware">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/articulos/030-Linux/">
    <meta property="og:image" content="/articulos/030-Linux/preview1.png">
    <meta property="og:description" content="El siguiente, más que un manual paso a paso, son los comandos utilizados en el video para preparar una instalación de Debian con el sistema de archivos BTRFS.">
    <meta property="og:site_name" content="Ethergroup | Blog">
    <title>Linux Anti Ransomware - Ethergroup | Blog</title>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="icon" href="/theme/images/icon-hires.png" sizes="192x192" />
    <link rel="icon" href="/theme/images/icon-normal.png" sizes="128x128" />
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon.png" />
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-76x76.png" sizes="76x76" />
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-120x120.png" sizes="120x120" />
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-152x152.png" sizes="152x152" />
    <link rel="apple-touch-icon" href="/theme/images/apple-touch-icon-180x180.png" sizes="180x180" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/css/bootstrap.min.css" integrity="sha512-GQGU0fMMi238uA+a/bdWJfpUGKUkBdgfFdgBm72SUQ6BeyWjoY/ton0tEjH+OSH9iP4Dfh+7HM0I9f5eR0L/4w==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" integrity="sha512-1ycn6IcaQQ40/MKBW2W4Rhis/DbILU74C1vSrLJxCq57o941Ym01SwNsOMqvEBFlcgUa6xLiPY/NS5R+E6ztJQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans&display=swap" />
    <link rel="stylesheet" href="/theme/css/movimientolibre-bs5.css" />
</head>
<body>
<nav id="navigationBase" class="navbar navbar-expand-sm fixed-top">
    <div class="container">
        <a class="navbar-brand" href="/"><i class="fa fa-home"></i></a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navigationCollapse" aria-controls="navigationCollapse" aria-expanded="false" aria-label="Toggle navigation">
            <span class="fas fa-bars"></span>
        </button>
        <div class="collapse navbar-collapse" id="navigationCollapse">
            <ul class="navbar-nav me-auto mb-2 mb-sm-0">
                <li class="nav-item"><a class="nav-link" href="/authors.html">Autores</a></li>
                <li class="nav-item"><a class="nav-link" href="/tags.html">Etiquetas</a></li>
                <li class="nav-item"><a class="nav-link" href="https://ethergroup.mx/">EtherGroup</a></li>
            </ul>
            <ul class="navbar-nav">
                <li><a class="mx-2" href="https://www.instagram.com/ethergroup/" target="_blank"><i class="fab fa-instagram-square fa-2x"></i></a></li>
                <li><a class="mx-2" href="https://www.facebook.com/EtherGroup-184831138858274" target="_blank"><i class="fab fa-facebook-square fa-2x"></i></a></li>
                <li><a class="mx-2" href="https://www.linkedin.com/company/ethergroup" target="_blank"><i class="fab fa-linkedin fa-2x"></i></a></li>
            </ul>
    </div>
    </div>
</nav><header id="headerSite" class="mb-4">
    <div id="headerSiteImage" class="container" itemscope itemtype="http://schema.org/Organization">
        <div class="row">
            <div class="col-xl-8">
                <h1 class="display-2" itemprop="name">Ethergroup | Blog</h1>
                <p class="lead" itemprop="description">Blog sobre tecnologías, hacking, ciberseguridad, software libre y mucho más</p>
            </div>
        </div>
    </div>
</header>    <div class="container">
        <div class="row">
            <div class="col-lg-8">
    <article>
        <script type="application/ld+json">
            {
                "@context": "http://schema.org",
                "@type": "Article",
                "publisher": {
                    "@type": "Organization",
                    "name": "Ethergroup | Blog",
                    "logo": {
                        "@type": "ImageObject",
                        "url": "/theme/images/ethergroup.png"
                    },
                    "url": ""
                },
                "author": "Imir Torres",
                "name": "Linux Anti Ransomware",
                "headline": "Linux Anti Ransomware",
                "description": "El siguiente, más que un manual paso a paso, son los comandos utilizados en el video para preparar una instalación de Debian con el sistema de archivos BTRFS.",
                "dateCreated": "2022-09-22 10:00:00-05:00",
                "datePublished": "2022-09-22 10:00:00-05:00",
                "dateModified": "",
                "image": "/articulos/030-Linux/preview1.png",
                "url": "/articulos/030-Linux/"
            }
        </script>
        <h2>Linux Anti Ransomware</h2>
        <p class="lead">El siguiente, más que un manual paso a paso, son los comandos utilizados en el video para preparar una instalación de Debian con el sistema de archivos BTRFS.</p>
        <p>22 September 2022</p>
        <p><img class="img-fluid" src="030.png" alt="Foto 0"></p>
<hr>
<p>Video de Referencia en Ethergroup: <a href="https://www.facebook.com/100063979955669/videos/753610122236359">https://www.facebook.com/100063979955669/videos/753610122236359</a></p>
<p>El siguiente, más que un manual paso a paso, son los comandos utilizados en el video para preparar una instalación de Debian con el sistema de archivos BTRFS. Esto nos servirá para volver de un ransomware en nuestras carpetas compartidas o simplemente para recuperar archivos borrados de nuestro servidor. De igual forma utilizaremos la herramienta Timeshift para manejar de forma más eficiente las copias y snapshots del sistema.</p>
<ul>
<li>Creamos una máquina virtual con Debian</li>
<li>Vamos a avanzado y con las opciones avanzadas entramos al menú de experto.</li>
<li>Configuramos cada una de las partes a utilizar</li>
<li>En particiones, escogemos manual.</li>
</ul>
<p>Creamos 3 particiones:</p>
<div class="highlight"><pre><span></span><code><span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Efi</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="mf">600</span><span class="w"> </span><span class="n">mb</span><span class="w"></span>
<span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">swap</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="mf">3</span><span class="w"> </span><span class="n">GB</span><span class="w"></span>
<span class="mf">1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">con</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">resto</span><span class="w"> </span><span class="n">sobre</span><span class="w"> </span><span class="n">btrfs</span><span class="w"></span>
</code></pre></div>

<ul>
<li>Luego de ello mandaremos el comando ctrl + alt + f2 -&gt; Esto para acceder a una shell</li>
</ul>
<p>Dentro de busybox, haremos lo siguiente:</p>
<p>Buscamos lo que contenga el sistema target</p>
<p>df</p>
<p>Desmontamos</p>
<div class="highlight"><pre><span></span><code>umount /target/boot/efi
umount /target
</code></pre></div>

<p>Ahora montaremos la información sobre mnt:</p>
<div class="highlight"><pre><span></span><code><span class="n">mount</span><span class="w"> </span><span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">sda3</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w">   </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="n">monta</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">que</span><span class="w"> </span><span class="n">tiene</span><span class="w"> </span><span class="n">el</span><span class="w"> </span><span class="n">indicador</span><span class="w"> </span><span class="n">target</span><span class="w"></span>
</code></pre></div>

<p>Luego entraremos a mnt para poder crear nuestros subvolumes:</p>
<div class="highlight"><pre><span></span><code><span class="n">cd</span><span class="w"> </span><span class="o">/</span><span class="n">mnt</span><span class="w"> </span><span class="n">btrfs</span><span class="w"> </span><span class="n">subvolume</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="err">@</span><span class="w">    </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">se</span><span class="w"> </span><span class="n">llama</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">esa</span><span class="w"> </span><span class="n">forma</span><span class="w"> </span><span class="n">porque</span><span class="w"> </span><span class="n">es</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">manera</span><span class="w"> </span><span class="n">de</span><span class="w"> </span><span class="n">llamar</span><span class="w">   </span><span class="n">a</span><span class="w"> </span><span class="n">la</span><span class="w"> </span><span class="n">base</span><span class="w"></span>
<span class="n">btrfs</span><span class="w"> </span><span class="n">subvolume</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="nv">@home</span><span class="w"></span>
<span class="n">btrfs</span><span class="w"> </span><span class="n">subvolume</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="nv">@snapshots</span><span class="w"></span>
<span class="n">btrfs</span><span class="w"> </span><span class="n">subvolume</span><span class="w"> </span><span class="n">list</span><span class="w"></span>
</code></pre></div>

<p>Ahora realizaremos lo siguiente:</p>
<div class="highlight"><pre><span></span><code>mount -o rw,noatime,compress=lzo,space_cache,subvolid=257,subvol=@ /dev/sda3 /target
</code></pre></div>

<p>Crearemos los directorios para montar los directorios:</p>
<div class="highlight"><pre><span></span><code>mkdir -p /target/home
mkdir -p /target/.snapshots

mount -o rw,noatime,compress=lzo,space_cache,subvolid=258,subvol=@ /dev/sda3 /target/home
mount -o rw,noatime,compress=lzo,space_cache,subvolid=259,subvol=@ /dev/sda3 /target/.snapshots

ls
</code></pre></div>

<p>Ahora hay que mover la información al volumen de target:</p>
<div class="highlight"><pre><span></span><code>mv etc/ /target/
mv media /target/
</code></pre></div>

<p>Veremos la carpeta boot, pero a este punto está vacía. Aprovechando esto, crearemos boot/efi dentro de la carpeta target:</p>
<div class="highlight"><pre><span></span><code>mkdir -p /target/boot/efi
</code></pre></div>

<p>Montamos la partición que contendrá el EFI dentro del sistema:</p>
<div class="highlight"><pre><span></span><code>mount /dev/sda1 /target/boot/efi/
</code></pre></div>

<p>Finalmente desmontamos /mnt</p>
<div class="highlight"><pre><span></span><code>umount /mnt
</code></pre></div>

<p>Ahora que tenemos eso, verificamos que todo esté en /target/</p>
<div class="highlight"><pre><span></span><code>boot etc home media
</code></pre></div>

<p>Es hora de modificar el archivo de fstab que contiene información vieja:</p>
<div class="highlight"><pre><span></span><code>cd etc

nano fstab
</code></pre></div>

<p>Utilizando el mismo UUID del disco, haremos lo siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="n">UUID</span><span class="o">=</span><span class="n">cnadscb4brjhb3jhbj</span><span class="o">/</span><span class="w"></span>
<span class="n">btrfsrw</span><span class="p">,</span><span class="n">noatime</span><span class="p">,</span><span class="nf">compress</span><span class="o">=</span><span class="n">lzo</span><span class="p">,</span><span class="n">space_cache</span><span class="p">,</span><span class="n">subvolid</span><span class="o">=</span><span class="mi">257</span><span class="p">,</span><span class="n">subvol</span><span class="o">=</span><span class="err">@</span><span class="w">  </span><span class="mi">0</span><span class="w">   </span><span class="mi">0</span><span class="w"></span>

<span class="n">UUID</span><span class="o">=</span><span class="n">cnadscb4brjhb3jhbj</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="w">       </span><span class="n">btrfs</span><span class="w">             </span><span class="n">rw</span><span class="p">,</span><span class="n">noatime</span><span class="p">,</span><span class="nf">compress</span><span class="o">=</span><span class="n">lzo</span><span class="p">,</span><span class="n">space_cache</span><span class="p">,</span><span class="n">subvolid</span><span class="o">=</span><span class="mi">258</span><span class="p">,</span><span class="n">subvol</span><span class="o">=</span><span class="nv">@home</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w"></span>

<span class="n">UUID</span><span class="o">=</span><span class="n">cnadscb4brjhb3jhbj</span><span class="w"> </span><span class="o">/</span><span class="p">.</span><span class="n">snapshots</span><span class="w">       </span><span class="n">btrfs</span><span class="w">        </span>
<span class="n">rw</span><span class="p">,</span><span class="n">noatime</span><span class="p">,</span><span class="nf">compress</span><span class="o">=</span><span class="n">lzo</span><span class="p">,</span><span class="n">space_cache</span><span class="p">,</span><span class="n">subvolid</span><span class="o">=</span><span class="mi">259</span><span class="p">,</span><span class="n">subvol</span><span class="o">=</span><span class="nv">@snapshots</span><span class="w">       </span><span class="mi">0</span><span class="w">       </span><span class="mi">0</span><span class="w"></span>
</code></pre></div>

<p>Para salir de la consola tecleamos ctrl + D y regresamos al menú de configuración:</p>
<ul>
<li>Realizaremos la instalación del entorno de escritorio para hacer uso de una herramienta llamada timeshift.</li>
</ul>
<p>Instalamos un escritorio sencillo.</p>
<p>Luego de que el sistema cargue completamente, iremos a los archivos de apt sources y
comentaremos la linea de cdrom.</p>
<p>Haremos un update:</p>
<div class="highlight"><pre><span></span><code>apt-get update
</code></pre></div>

<p>Instalamos:</p>
<div class="highlight"><pre><span></span><code>apt-get install git vim timeshift
</code></pre></div>

<p>A modo de ejemplo, crearemos un snapshot con btrfs:</p>
<div class="highlight"><pre><span></span><code>sudo btrfs subvolume snapshot / /.snapshots/unnombreofecha-root-snapshot
sudo btrfs subvolume list /
</code></pre></div>

<p>La aplicación de timeshift es bastante intuitiva y nos permitirá regresar a snapshots parciales o totales del sistema.</p>
<p>¡Happy Hacking!</p>
    </article>
            </div>
            <div class="col-lg-4">
                <aside>
<div id="asideAbout" class="card border-0">
    <div class="card-body">
        <h3 class="card-title mt-0">A cerca de EtherGroup</h3>
        <p class="card-text">
            Ethergroup es una empresa mexicana dedicada 
            a proveer servicios integrales en tecnologías
            de Información. Lideramos la transformación 
            tecnológica de nuestros clientes paso a paso, 
            de forma segura y fungimos como impulso a su 
            negocio en esta era digital.
            <br> <br>
            En Ethergroup nos encanta compartir 
            contenido te dejamos este espacio, 
            que busca divulgar conocimiento de 
            diferentes áreas.
        </p>
    </div>
</div><div id="asideTags" class="card border-0">
    <div class="card-body">
        <h3 class="card-title mt-0">Etiquetas</h3>
        <ul class="list-group list-group-flush">
<li class="list-group-item"><a href="/tag/ciberataque.html">Ciberataque</a></li><li class="list-group-item"><a href="/tag/ciberataques.html">Ciberataques</a></li><li class="list-group-item"><a href="/tag/ciberseguridad.html">Ciberseguridad</a></li><li class="list-group-item"><a href="/tag/hacking.html">Hacking</a></li><li class="list-group-item"><a href="/tag/linux.html">Linux</a></li><li class="list-group-item"><a href="/tag/malware.html">Malware</a></li><li class="list-group-item"><a href="/tag/programacion.html">Programación</a></li><li class="list-group-item"><a href="/tag/ransomware.html">Ransomware</a></li><li class="list-group-item"><a href="/tag/servidores.html">Servidores</a></li><li class="list-group-item"><a href="/tag/vulnerabilidad.html">Vulnerabilidad</a></li>        </ul>
    </div>
</div>                </aside>
            </div>
        </div>
    </div>
<footer class="text-muted">
    <div class="container">
        <p>
            Copyright &copy; Ethergroup 2021 | Cybersecurity E-group S. de R.L. de C.V. Sitio web de la empresa Ethergroup.
            Sitio web de la empresa <a href="https://ethergroup.mx/">EtherGroup.</a> 
        </p>
    </div>
</footer>    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" integrity="sha512-894YE6QWD5I59HgZOGReFYm4dnWc1Qt5NtvYSaNcOP+u1T9qYdvdihz0PPSiiqn/+/3e7Jo4EaG7TubfWGUrMQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.1.3/js/bootstrap.min.js" integrity="sha512-OvBgP9A2JBgiRad/mM36mkzXSXaJE9BEIENnVEmeZdITvwT09xnxLtT4twkCa8m/loMbPHsvPl0T8lRGVBwjlQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="/theme/js/navigation.js"></script>
</body>
</html>